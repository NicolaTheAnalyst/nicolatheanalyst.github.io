<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Count if yellow: a dumb yet useful vba function :: Love letters to my future self</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="What a time to be alive: soon enough we are going to see even electric kettles with GTP-4 capabilities and yet, we still don&amp;rsquo;t have a proper way to count cells based on colour in Excel.
It&amp;rsquo;s not a big deal, just a few lines in VBA that, since it&amp;rsquo;s not the first time I&amp;rsquo;m needing, I&amp;rsquo;ll just paste here:
Function COUNTIFYELLOW(CountRange As Range) &amp;#39;CountRange represents the cell range you are applying this to Dim yellow As Integer Dim TotalCount As Integer yellow = 6 &amp;#39;6 is the color index number of the particular yellow I was using, hardcoding is not cool, I know Set rCell = CountRange &amp;#39;for every cell of the select range, increment 1 if yellow For Each rCell In CountRange If rCell." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://nicolatheanalyst.github.io/post/count-if-yellow-a-dumb-vba-function/" />




<link rel="stylesheet" href="https://nicolatheanalyst.github.io/assets/style.css">

  <link rel="stylesheet" href="https://nicolatheanalyst.github.io/assets/green.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://nicolatheanalyst.github.io/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="https://nicolatheanalyst.github.io/img/favicon/green.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Count if yellow: a dumb yet useful vba function :: Love letters to my future self">
<meta property="og:description" content="&#39;cause it should be a standard function but it is what it is" />
<meta property="og:url" content="https://nicolatheanalyst.github.io/post/count-if-yellow-a-dumb-vba-function/" />
<meta property="og:site_name" content="Count if yellow: a dumb yet useful vba function" />

  
    <meta property="og:image" content="https://nicolatheanalyst.github.io/img/favicon/green.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2023-03-24 00:00:00 &#43;0000 UTC" />












</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Love letters to my future self
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://nicolatheanalyst.github.io/post/count-if-yellow-a-dumb-vba-function/">Count if yellow: a dumb yet useful vba function</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2023-03-24 [Updated: 2023-03-24]
      </span>
    
    
  </div>

  

  

  

  <div class="post-content"><div>
        <p>What a time to be alive: soon enough we are going to see even electric kettles with GTP-4 capabilities and yet, we still don&rsquo;t have a proper way to count cells based on colour in Excel.</p>
<p>It&rsquo;s not a big deal, just a few lines in VBA that, since it&rsquo;s not the first time I&rsquo;m needing, I&rsquo;ll just paste here:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vb" data-lang="vb"><span style="display:flex;"><span><span style="color:#66d9ef">Function</span> <span style="color:#a6e22e">COUNTIFYELLOW</span>(CountRange <span style="color:#f92672">As</span> Range) <span style="color:#75715e">&#39;CountRange represents the cell range you are applying this to
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">Dim</span> yellow <span style="color:#f92672">As</span> <span style="color:#66d9ef">Integer</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Dim</span> TotalCount <span style="color:#f92672">As</span> <span style="color:#66d9ef">Integer</span>
</span></span><span style="display:flex;"><span>yellow <span style="color:#f92672">=</span> 6 <span style="color:#75715e">&#39;6 is the color index number of the particular yellow I was using, hardcoding is not cool, I know
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Set</span> rCell <span style="color:#f92672">=</span> CountRange <span style="color:#75715e">&#39;for every cell of the select range, increment 1 if yellow
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">For</span> <span style="color:#66d9ef">Each</span> rCell <span style="color:#f92672">In</span> CountRange
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">If</span> rCell.Interior.ColorIndex <span style="color:#f92672">=</span> yellow <span style="color:#66d9ef">Then</span>
</span></span><span style="display:flex;"><span>    TotalCount <span style="color:#f92672">=</span> TotalCount <span style="color:#f92672">+</span> 1 
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">End</span> <span style="color:#66d9ef">If</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Next</span> rCell
</span></span><span style="display:flex;"><span>COUNTIFYELLOW <span style="color:#f92672">=</span> TotalCount
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">End</span> <span style="color:#66d9ef">Function</span>
</span></span></code></pre></div><p>But what if you need to count cells based on another colour? How would you know the colour index? With another dumb yet fairly useful custom function, of course:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vb" data-lang="vb"><span style="display:flex;"><span><span style="color:#66d9ef">Function</span> <span style="color:#a6e22e">GETCOLORINDEX</span>(cell <span style="color:#f92672">As</span> Range)
</span></span><span style="display:flex;"><span>GETCOLORINDEX <span style="color:#f92672">=</span> cell.Interior.ColorIndex
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">End</span> <span style="color:#66d9ef">Function</span>
</span></span></code></pre></div><p>Just select the coloured cell you need to pick the colour index from, and you&rsquo;ll get the corresponding integer.</p>
<p>Now, yes, <strong>hardcoding values is bad practice</strong>. Even in Excel, I guess. So to make the colour index dynamic, you can add another argument to the first function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vb" data-lang="vb"><span style="display:flex;"><span><span style="color:#66d9ef">Function</span> <span style="color:#a6e22e">COUNTIFYELLOW</span>(CountRange <span style="color:#f92672">As</span> Range, ColourRange <span style="color:#f92672">As</span> Range)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Dim</span> colour <span style="color:#f92672">As</span> <span style="color:#66d9ef">Integer</span>
</span></span><span style="display:flex;"><span>colour <span style="color:#f92672">=</span> ColourRange.Interior.ColorIndex <span style="color:#75715e">&#39;get the colour from the cell in the second argument
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">Dim</span> TotalCount <span style="color:#f92672">As</span> <span style="color:#66d9ef">Integer</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Set</span> rCell <span style="color:#f92672">=</span> CountRange <span style="color:#75715e">&#39;for every cell of the select range, increment 1 if the colour index matches
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">For</span> <span style="color:#66d9ef">Each</span> rCell <span style="color:#f92672">In</span> CountRange
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">If</span> rCell.Interior.ColorIndex <span style="color:#f92672">=</span> colour <span style="color:#66d9ef">Then</span>
</span></span><span style="display:flex;"><span>    TotalCount <span style="color:#f92672">=</span> TotalCount <span style="color:#f92672">+</span> 1 
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">End</span> <span style="color:#66d9ef">If</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Next</span> rCell
</span></span><span style="display:flex;"><span>COUNTIFYELLOW <span style="color:#f92672">=</span> TotalCount
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">End</span> <span style="color:#66d9ef">Function</span>
</span></span></code></pre></div><p>With the second argument (ColourRange), point to the cell with the colour you are interested into getting and you are ready to go.</p>
<p>Now, what if you need to manage more than one colour and more than one increment type? Say, add 1 if &ldquo;yellow&rdquo; and 0,5 if &ldquo;blu&rdquo;</p>
<p>This should do:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vb" data-lang="vb"><span style="display:flex;"><span><span style="color:#66d9ef">Function</span> <span style="color:#a6e22e">COUNTIFYELLOW</span>(CountRange <span style="color:#f92672">As</span> Range)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Dim</span> yellow <span style="color:#f92672">As</span> <span style="color:#66d9ef">Integer</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Dim</span> blu <span style="color:#f92672">As</span> <span style="color:#66d9ef">Double</span> <span style="color:#75715e">&#39;to have decimals, we are going to need this to be a Double
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">Dim</span> TotalCount <span style="color:#f92672">As</span> <span style="color:#66d9ef">Double</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>yellow <span style="color:#f92672">=</span> 6 <span style="color:#75715e">&#39;yeah, still hardcoding indexes here
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>blu <span style="color:#f92672">=</span> 23 <span style="color:#75715e">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Set</span> rCell <span style="color:#f92672">=</span> CountRange
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">For</span> <span style="color:#66d9ef">Each</span> rCell <span style="color:#f92672">In</span> CountRange <span style="color:#75715e">&#39;adds 1 if yellow and 0,5 if blu
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">If</span> rCell.Interior.ColorIndex <span style="color:#f92672">=</span> yellow <span style="color:#66d9ef">Then</span>
</span></span><span style="display:flex;"><span>    TotalCount <span style="color:#f92672">=</span> TotalCount <span style="color:#f92672">+</span> 1
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">ElseIf</span> rCell.Interior.ColorIndex <span style="color:#f92672">=</span> blu <span style="color:#66d9ef">Then</span>
</span></span><span style="display:flex;"><span>    TotalCount <span style="color:#f92672">=</span> TotalCount <span style="color:#f92672">+</span> 0.5 
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">End</span> <span style="color:#66d9ef">If</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Next</span> rCell
</span></span><span style="display:flex;"><span>COUNTIFYELLOW <span style="color:#f92672">=</span> TotalCount
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">End</span> <span style="color:#66d9ef">Function</span>
</span></span></code></pre></div>
      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        
        <span class="button next">
            <a href="https://nicolatheanalyst.github.io/post/pandas-save/">
                <span class="button__text">Pandas ExcelWriter Save method</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  

</div>

  </div>

  
    <footer class="footer">
<div style="width:100%; text-align:center;">
  <div style="width: 50%; margin: 0px auto; text-align:center;">© 2023 Powered by <a href="http://gohugo.io">Hugo</a></div>
</div>
</footer>

<script src="https://nicolatheanalyst.github.io/assets/main.js"></script>
<script src="https://nicolatheanalyst.github.io/assets/prism.js"></script>





  
</div>

</body>
</html>
